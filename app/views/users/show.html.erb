<div class="user_show">
  <%= image_tag(@user.avatar.url(:original), class: "icon_medium") %>
  <h1><%= @user.username %></h1>
</div>

<%= render "layouts/profile_bar" %>
<div class="scripts_container">
  <% if @user == current_user && @scripts.empty? %>
    <span class="title" style="text-align: center;"><%= link_to 'Upload Script', new_script_path %></span>
    Add a script to see them displayed here!
  <% else %>
  <% end %>
  <br>
  <% if !@scripts.empty? %>
    <% @scripts.each_slice(4) do |script_row| %>
      <div class="script_row">
        <% script_row.each do |script| %>
          <div class="script">
            <%= link_to image_tag('script_icon.png'), script, class: "icon_thumb" %>
            <br>
            <span class="title"><%= link_to script.title, script %></span>
            <br>
            <p><%= script.logline %></p>
            <% if script.user == current_user %>
              <span class="button"><%= link_to 'Edit', edit_script_path(script) %></span>
              <span class="button"><%= link_to 'Delete', script, method: :delete, data: { confirm: 'Are you sure you want to delete this script?  (You will lose all notes posted to this script)' } %></span>
            <% end %>
          </div>
        <% end %>
      </div>
    <% end %>
    <% else %>
    <p>This User hasn't uploaded any scripts!</p>
  <% end %>
</div>

<div class="groups_container">
  <% if @user == current_user && @groups.empty? %>
    <p>Join a group to see them displayed here!</p>
  <% elsif !@groups.empty? %>
      <% @groups.each_slice(4) do |group_row| %>
        <div class="group_row">
          <% group_row.each do |group| %>
            <div class="group">
              <%= link_to image_tag(group.image.url(:original)), group, class: "icon_thumb" %>
              <br>
              <span class="title"><%= link_to group.title, group %></span>
              <br>
              <% if group.users.include?(current_user) %>
                <span class="button"><%= link_to "Leave Group", group_user_path(user: current_user, group: group), method: :delete, data: {confirm: "Are you sure you want to leave the group?"} %></span>
              <% else %>
                <% if group.pending?(current_user) %>
                  (Request Pending...)
                <% elsif group.is_private %>
                  (<%= link_to 'Request to Join', group_users_path(user: current_user, group: group, accepted: false), method: :create %>)
                <% else %>
                  (<%= link_to 'Join Group', group_users_path(user: current_user, group: group, accepted: true), method: :create %>)
                <% end %>
              <% end %>
            </div>
          <% end %>
        </div>
      <% end %>
  <% else %>
    <p>This User hasn't joined any groups!</p>
  <% end %>
</div>